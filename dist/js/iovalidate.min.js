!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.ioValidate=b()}(this,function(){"use strict";var a=function(a){var b={},c=a.attributes;if("undefined"!=typeof c)for(var d=0;d<c.length;d++)b[c[d].nodeName]=a.getAttribute(c[d].nodeName);return b},b=function(a){if(this.validators={},this.error_render_function=null,this.error_render_target=null,this.error_text={required:"This field is required",email:"This is not a valid email address"},this.error_text_field={},this.errors={},"string"==typeof a){var b=document.querySelectorAll(a);if(0===b.length)throw new Error('ioValidate error: Selector ["'+a+'"] returns no elements');b.length>1&&(console.log('ioValidate warning: Selector ["'+a+'"] returns more than one element. All but the first element will be ignored. Selected elements are:'),console.log(b)),a=b[0]}else if("object"==typeof a&&!(a instanceof HTMLElement))if("undefined"!=typeof a.length){if(0===a.length)throw new Error("ioValidate error: Collection contains no elements");a.length>1&&(console.log("ioValidate warning: Collection contains more than one element. All but the first element will be ignored. Selected elements are:"),console.log(a)),a=a[0]}else a instanceof ioForm&&(a=a.GetElement());if(a instanceof HTMLElement){if(a.ioValidate)return a.ioValidate;a.ioValidate=this,a.setAttribute("novalidate","");var c=new ioForm(a);this.FromForm(c)}else alert("Objects not yet supported")};return b.prototype={FromForm:function(c){if("undefined"==typeof b)return void console.log("ioValidate requires ioForm");this.validators={};var d=c.GetFields(),e=[],f=[];for(var g in d)if(d.hasOwnProperty(g)){var h=d[g],i=a(h.GetElement());for(var j in i)if(i.hasOwnProperty(j))switch(j){case"required":case"min":case"max":case"step":case"maxlength":e.push({field:h,type:j,settings:i[j]});break;case"type":var k=["email"];k.indexOf(i[j])!==-1&&e.push({field:h,type:i[j],settings:{}});break;default:if("data-iovalidate-"===j.substr(0,16)||"data-iov-"===j.substr(0,9)){var l=j.match(/^(data\-iovalidate\-|data\-iov\-)(.*)$/)[2];"error-"===l.substr(0,6)?f.push({field:h,type:l.substr(6),settings:i[j]}):e.push({field:h,type:l,settings:i[j]})}}}for(var m=0;m<e.length;m++){var n=e[m];this.AddValidator(n.field,n.type,n.settings)}for(m=0;m<f.length;m++){var o=f[m];this.AddErrorText(o.field,o.type,o.settings)}c.on("reset",function(a){this.ClearFormErrors(new ioForm(a.target))}.bind(this))},DoFormValidation:function(a){var b=new ioForm(a.target);this.ClearFormErrors(b),this.Validate(b.GetValues())?b.trigger("iovalidate:valid"):(a.preventDefault(),a.stopImmediatePropagation(),this.RenderFormErrors(b,this.errors),b.trigger("iovalidate:invalid",{errors:this.errors}))},AddValidator:function(a,b,c){var d=a.GetName();"undefined"==typeof this.validators[d]&&(this.validators[d]=[]),this.validators[d].push({type:b,settings:c,enabled:!0})},AddErrorText:function(a,b,c){var d=a.GetName();"undefined"==typeof this.errors[d]&&(this.error_text_field[d]={}),this.error_text_field[d][b]=c},GetErrorText:function(a,b){return"undefined"!=typeof this.error_text_field[b]&&"undefined"!=typeof this.error_text_field[b][a]?this.error_text_field[b][a]:"undefined"!=typeof this.error_text[a]?this.error_text[a]:"This value is not valid"},Validate:function(a){var b=!0;for(var c in a)a.hasOwnProperty(c)&&(this.ValidateValue(c,a[c],a)||(b=!1));return b},ValidateValue:function(a,b,c){this.ClearErrors(a);var d=!0;if("undefined"!=typeof this.validators[a])for(var e=0;e<this.validators[a].length;e++){var f=this.validators[a][e],g=f.settings,h=new window["ioValidateValidator_"+f.type](g);h.Validate(b,c)||(this.AddError(a,this.GetErrorText(f.type,a)),d=!1)}return d},ClearErrors:function(a){"undefined"!=typeof this.errors[a]&&delete this.errors[a]},AddError:function(a,b){"undefined"==typeof this.errors[a]&&(this.errors[a]=[]),this.errors[a].push(b)},GetErrors:function(){return this.errors},ClearFormErrors:function(a){for(var b=a.GetElement(),c=b.querySelectorAll("[data-iovalidate-errors-for]"),d=0;d<c.length;d++)c[d].parentNode.removeChild(c[d]);a.trigger("iovalidate:clearformerrors")},SetErrorRenderFunction:function(a){this.error_render_function=a},SetErrorRenderTarget:function(a){this.error_render_target=a},RenderFormErrors:function(a,b){var c=a.GetElement();for(var d in b)if(this.errors.hasOwnProperty(d)){for(var e=c.querySelector('[name="'+d+'"]'),f="",g=0;g<b[d].length;g++)f+="<li>"+b[d][g]+"</li>";var h=c.querySelector('[data-iovalidate-errors-for="'+d+'"]');h&&h.parentNode.removeChild(h);var i=parseHTML('<ul class="errors" data-iovalidate-errors-for="'+d+'">'+f+"</ul>");null!==this.error_render_target&&"function"==typeof this.error_render_target?this.error_render_target(e,i):e.parentNode.insertBefore(i,e.nextSibling)}}},b});var ioValidateValidator=function(a){this.settings=a};ioValidateValidator.prototype={Validate:function(){alert("Validate function not defined")}};var ioValidateValidator_required=function(a){ioValidateValidator.call(this,a)};extend(ioValidateValidator_required,ioValidateValidator),ioValidateValidator_required.prototype.Validate=function(a){var b=!0;switch(typeof a){case"boolean":b=a===!0;break;case"string":b=""!==a;break;case"object":b=Array.isArray(a)?a.length>0:null!==a}return b};var ioValidateValidator_email=function(a){ioValidateValidator.call(this,a)};extend(ioValidateValidator_email,ioValidateValidator),ioValidateValidator_email.prototype.Validate=function(a){var b=!0;return""==a||a.match(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i)||(b=!1),b};var ioValidateValidator_equal=function(a){ioValidateValidator.call(this,a)};extend(ioValidateValidator_equal,ioValidateValidator),ioValidateValidator_equal.prototype.Validate=function(a,b){var c=!0;return""!==b[this.settings]&&a!=b[this.settings]&&(c=!1),c};var ioValidateValidator_greaterequal=function(a){ioValidateValidator.call(this,a)};if(extend(ioValidateValidator_greaterequal,ioValidateValidator),ioValidateValidator_greaterequal.prototype.Validate=function(a,b){var c=!0;return null!==a&&null!==b[this.settings]&&a<b[this.settings]&&(c=!1),c},"function"!=typeof extend){"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b});var extend=function(a,b){var c=Object.create(b.prototype);c.constructor=a,a.prototype=c}}var parseHTML=function(){var a=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,b=/<([\w:]+)/,c=/<|&#?\w+;/,d={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};return function(e,f){f=f||document;var g,h,i,j,k=f.createDocumentFragment();if(c.test(e)){for(g=k.appendChild(f.createElement("div")),h=(b.exec(e)||["",""])[1].toLowerCase(),i=d[h]||d._default,g.innerHTML=i[1]+e.replace(a,"<$1></$2>")+i[2],j=i[0];j--;)g=g.lastChild;for(k.removeChild(k.firstChild);g.firstChild;)k.appendChild(g.firstChild)}else k.appendChild(f.createTextNode(e));return k}}();